version: '3.9'

services:
  relayer:
    build:
      context: ./relayer
      dockerfile: Dockerfile
    container_name: shadowbridge-relayer
    env_file:
      - ./relayer/.env
    environment:
      - NODE_ENV=production
      - PORT=3001
    ports:
      - '3001:3001'
    depends_on:
      - prover
    restart: unless-stopped

  prover:
    build:
      context: ./relayer/prover
      dockerfile: Dockerfile
    container_name: shadowbridge-prover
    env_file:
      - ./relayer/prover/.env
    environment:
      - PROVER_PORT=4001
    ports:
      - '4001:4001'
    volumes:
      - ./contracts/midnight/circuits/build:/app/contracts/midnight/circuits/build:ro
    restart: unless-stopped

